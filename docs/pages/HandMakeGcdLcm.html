<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCD & LCM è®¡ç®—å™¨</title>
    <style>
        :root[data-theme="light"] {
            --bg-color: #f8f6fc;
            --container-bg: white;
            --text-color: #1d1b20;
            --border-color: #e6e0e9;
            --button-bg: #6750a4;
            --button-hover: #7c6db8;
            --input-focus: #d0bcff;
            --shadow-color: rgba(103, 80, 164, 0.1);
        }
        
        :root[data-theme="dark"] {
            --bg-color: #1d1b20;
            --container-bg: #2b2930;
            --text-color: #e6e0e9;
            --border-color: #49454f;
            --button-bg: #d0bcff;
            --button-hover: #b69df8;
            --input-focus: #6750a4;
            --shadow-color: rgba(208, 188, 255, 0.1);
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.5;
        }

        .container {
            background-color: var(--container-bg);
            padding: 24px;
            border-radius: 28px;
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        .input-group {
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        input {
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            background-color: var(--container-bg);
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.2s ease;
            width: 150px;
        }

        input:focus {
            outline: none;
            border-color: var(--input-focus);
            box-shadow: 0 0 0 2px var(--input-focus);
        }

        button {
            padding: 12px 24px;
            background-color: var(--button-bg);
            color: var(--theme-color, white);
            border: none;
            border-radius: 100px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        button:hover {
            background-color: var(--button-hover);
            transform: translateY(-1px);
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            height: 48px;
            border-radius: 24px;
            background-color: var(--container-bg);
            box-shadow: 0 2px 4px var(--shadow-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            min-width: 48px;
            max-width: 48px;
        }

        .theme-toggle:hover {
            max-width: 200px;
        }

        .theme-icon::before {
            content: 'ğŸŒ';
        }

        .theme-text {
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .theme-toggle:hover .theme-text {
            opacity: 1;
        }

        .number-box {
            padding: 8px 16px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background-color: var(--container-bg);
            min-width: 60px;
            text-align: center;
            font-family: 'Consolas', monospace;
            font-size: 16px;
        }

        .factor-box {
            padding: 8px 16px;
            border-radius: 12px;
            background-color: var(--button-bg);
            color: var(--theme-color, white);
            min-width: 40px;
            text-align: center;
            font-weight: 500;
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-color);
        }

        .step-row {
            margin: 16px 0;
            padding: 12px;
            border-radius: 16px;
            background-color: var(--bg-color);
        }

        .result-row {
            margin-top: 24px;
            font-size: 18px;
            font-weight: 500;
        }

        /* ä¿®æ”¹åŠ¨ç”»æ•ˆæœä½¿å…¶æ›´å¹³æ»‘ */
        .step-row, .result-row {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* é€‚é…æ·±è‰²æ¨¡å¼çš„æ–‡å­—é¢œè‰² */
        :root[data-theme="dark"] button {
            color: #1d1b20;
        }

        :root[data-theme="dark"] .factor-box {
            color: #1d1b20;
        }

        /* æ·±è‰²æ¨¡å¼æ ·å¼ */
        :root[data-theme="dark"] .theme-icon::before {
            content: 'ğŸŒœ';
        }

        /* å…¶ä½™å“åº”å¼è®¾è®¡ä»£ç ä¿æŒä¸å˜ */
        @media screen and (max-width: 768px) {
            body {
                margin: 10px;
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            .input-group {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }

            input {
                width: 80%;
                max-width: 300px;
            }

            button {
                width: 80%;
                max-width: 300px;
            }

            .step-row {
                flex-wrap: wrap;
                justify-content: center;
            }

            .number-block {
                flex-wrap: wrap;
                justify-content: center;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                height: 40px;
                min-width: 40px;
            }

            h1 {
                font-size: 1.5em;
                text-align: center;
            }

            .result-row {
                padding-right: 0;
                justify-content: center;
                gap: 15px;
            }
        }

        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .number-box {
                min-width: 45px;
                padding: 5px 10px;
            }

            .factor-box {
                min-width: 30px;
            }

            h1 {
                font-size: 1.2em;
            }
        }

        .step-row {
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s ease forwards;
            animation-delay: calc(var(--index) * 0.1s);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-row {
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s ease forwards;
            animation-delay: calc(var(--index) * 0.1s);
        }

        .number-block {
            display: flex;
            align-items: center;
            gap: 12px;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢æ·±æµ…æ¨¡å¼">
        <span class="theme-icon"></span>
        <span class="theme-text"></span>
    </button>
    <div class="container">
        <h1>æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°è®¡ç®—å™¨</h1>
        <div class="input-group">
            <input type="number" id="num1" placeholder="è¾“å…¥ç¬¬ä¸€ä¸ªæ•°">
            <input type="number" id="num2" placeholder="è¾“å…¥ç¬¬äºŒä¸ªæ•°">
            <button onclick="calculate()">è®¡ç®—</button>
        </div>
        <div id="steps"></div>
        <div id="result"></div>
    </div>

    <script>
        function calculate() {
            let a = parseInt(document.getElementById('num1').value);
            let b = parseInt(document.getElementById('num2').value);
            
            if(isNaN(a) || isNaN(b) || a < 0 || b < 0) {  // ä¿®æ”¹è¿™é‡Œï¼Œå…è®¸0
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„è‡ªç„¶æ•°ï¼');
                return;
            }

            let stepsDiv = document.getElementById('steps');
            let resultDiv = document.getElementById('result');
            stepsDiv.innerHTML = '<h3>è®¡ç®—æ­¥éª¤ï¼š</h3>';
            let stepIndex = 0;
            
            // ç¡®ä¿ a æ˜¯è¾ƒå¤§çš„æ•°
            if(a < b) {
                [a, b] = [b, a];
            }

            let originalA = a;
            let originalB = b;
            let factors = [];
            let factTemp = 2;

            function addStepRow(factor, num1, num2, isResult = false) {
                const row = document.createElement('div');
                row.className = 'step-row';
                row.style.setProperty('--index', stepIndex++);

                if (!isResult) {
                    row.innerHTML = `
                        <div class="factor-box">${factor}</div>
                        <div class="number-block">
                            <div class="number-box">${num1}</div>
                            <div class="number-box">${num2}</div>
                        </div>
                    `;
                } else {
                    row.innerHTML = `
                        <div class="factor-box" style="visibility: hidden;">0</div>
                        <div class="number-block">
                            <div class="number-box">${num1}</div>
                            <div class="number-box">${num2}</div>
                        </div>
                    `;
                }
                stepsDiv.appendChild(row);
                
                // æ·»åŠ è‡ªåŠ¨æ»šåŠ¨
                setTimeout(() => {
                    row.scrollIntoView({ behavior: 'smooth', block: 'end' });
                }, stepIndex * 200); // ä¸åŠ¨ç”»å»¶è¿ŸåŒæ­¥
            }

            while(factTemp <= a/2 + 1) {
                if(a % factTemp === 0 && b % factTemp === 0) {
                    addStepRow(factTemp, a, b);
                    a /= factTemp;
                    b /= factTemp;
                    factors.push(factTemp);
                    factTemp = 1;
                }
                factTemp++;
            }

            addStepRow('', a, b, true);

            let gcd = factors.reduce((acc, curr) => acc * curr, 1);
            let lcm = (originalA * originalB) / gcd;

            resultDiv.innerHTML = '';
            const resultContent = [
                { label: 'æœ€å¤§å…¬çº¦æ•°', value: gcd },
                { label: 'æœ€å°å…¬å€æ•°', value: lcm }
            ];

            resultContent.forEach((item, index) => {
                const p = document.createElement('div');
                p.className = 'step-row result-row';
                p.style.setProperty('--index', stepIndex + index);
                p.innerHTML = `
                    <div class="result-label">${item.label}ï¼š</div>
                    <div class="number-box result-value">${item.value}</div>
                `;
                resultDiv.appendChild(p);
            });
        }

        // ä¿®æ”¹ toggleTheme å‡½æ•°
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            const themeText = document.querySelector('.theme-text');
            
            document.body.style.opacity = '0';
            
            setTimeout(() => {
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                document.body.style.opacity = '1';
                
                // æ›´æ–°åˆ‡æ¢æ–‡æœ¬
                themeText.textContent = newTheme === 'light' ? 'åˆ‡æ¢è‡³æ·±è‰²' : 'åˆ‡æ¢è‡³æµ…è‰²';
            }, 300);
        }

        // æ·»åŠ åˆ° DOMContentLoaded äº‹ä»¶ç›‘å¬å™¨ä¸­
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.body.style.opacity = '1';
            
            // åˆå§‹åŒ–ä¸»é¢˜åˆ‡æ¢æ–‡æœ¬
            const themeText = document.querySelector('.theme-text');
            themeText.textContent = savedTheme === 'light' ? 'åˆ‡æ¢è‡³æ·±è‰²' : 'åˆ‡æ¢è‡³æµ…è‰²';
        });
    </script>
</body>
</html>
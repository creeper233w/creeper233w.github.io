<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCD & LCM ËÆ°ÁÆóÂô®</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .container {
            background-color: var(--container-bg);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-group {
            margin-bottom: 20px;
        }
        input {
            padding: 8px;
            margin: 5px;
            width: 150px;
            background-color: var(--container-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        button {
            padding: 10px 20px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: var(--button-hover);
        }
        #steps {
            margin-top: 20px;
            border: 1px solid var(--border-color);
            padding: 10px;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
        }
        :root[data-theme="light"] {
            --bg-color: #f5f5f5;
            --container-bg: white;
            --text-color: #333;
            --border-color: #ddd;
            --button-bg: #4CAF50;
            --button-hover: #45a049;
        }
        :root[data-theme="dark"] {
            --bg-color: #1a1a1a;
            --container-bg: #2d2d2d;
            --text-color: #e0e0e0;
            --border-color: #404040;
            --button-bg: #45a049;
            --button-hover: #3d8b40;
        }
        * {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: var(--container-bg);
            border: 1px solid var(--border-color);
        }
        .theme-toggle:hover {
            transform: scale(1.1);
        }
        .step-row {
            opacity: 0;
            transform: translateY(-20px);
            animation: slideIn 0.5s forwards;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .number-box {
            padding: 5px 15px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--container-bg);
            min-width: 60px;
            text-align: center;
            font-family: 'Consolas', monospace;
        }
        .number-block {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .divider {
            width: 2px;
            height: 30px;
            background-color: var(--border-color);
            margin: 0 10px;
        }
        .factor-box {
            padding: 5px 10px;
            border: 2px solid var(--button-bg);
            border-radius: 4px;
            background-color: var(--button-bg);
            color: white;
            min-width: 40px;
            text-align: center;
        }
        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .step-row:nth-child(n) {
            animation-delay: calc(0.2s * var(--index));
        }
        .result-row {
            justify-content: flex-end;
            padding-right: 50px;
        }
        
        .result-label {
            font-size: 1.1em;
            color: var(--text-color);
            opacity: 0;
            transform: translateX(-20px);
            animation: slideInLabel 0.5s forwards;
            animation-delay: calc(0.2s * var(--index));
        }

        .result-value {
            opacity: 0;
            transform: scale(0.8);
            animation: popIn 0.5s forwards;
            animation-delay: calc(0.2s * var(--index) + 0.3s);
        }

        @keyframes slideInLabel {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                transform: scale(1.1);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media screen and (max-width: 768px) {
            body {
                margin: 10px;
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            .input-group {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }

            input {
                width: 80%;
                max-width: 300px;
            }

            button {
                width: 80%;
                max-width: 300px;
            }

            .step-row {
                flex-wrap: wrap;
                justify-content: center;
            }

            .number-block {
                flex-wrap: wrap;
                justify-content: center;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                width: 35px;
                height: 35px;
            }

            h1 {
                font-size: 1.5em;
                text-align: center;
            }

            .result-row {
                padding-right: 0;
                justify-content: center;
                gap: 15px;
            }
        }

        /* Êõ¥Â∞èÂ±èÂπïÁöÑ‰ºòÂåñ */
        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .number-box {
                min-width: 45px;
                padding: 5px 10px;
            }

            .factor-box {
                min-width: 30px;
            }

            h1 {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢Ê∑±ÊµÖÊ®°Âºè">
        üåì
    </button>
    <div class="container">
        <h1>ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÂíåÊúÄÂ∞èÂÖ¨ÂÄçÊï∞ËÆ°ÁÆóÂô®</h1>
        <div class="input-group">
            <input type="number" id="num1" placeholder="ËæìÂÖ•Á¨¨‰∏Ä‰∏™Êï∞">
            <input type="number" id="num2" placeholder="ËæìÂÖ•Á¨¨‰∫å‰∏™Êï∞">
            <button onclick="calculate()">ËÆ°ÁÆó</button>
        </div>
        <div id="steps"></div>
        <div id="result"></div>
    </div>

    <script>
        function calculate() {
            let a = parseInt(document.getElementById('num1').value);
            let b = parseInt(document.getElementById('num2').value);
            
            if(isNaN(a) || isNaN(b) || a < 0 || b < 0) {  // ‰øÆÊîπËøôÈáåÔºåÂÖÅËÆ∏0
                alert('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑËá™ÁÑ∂Êï∞ÔºÅ');
                return;
            }

            let stepsDiv = document.getElementById('steps');
            let resultDiv = document.getElementById('result');
            stepsDiv.innerHTML = '<h3>ËÆ°ÁÆóÊ≠•È™§Ôºö</h3>';
            let stepIndex = 0;
            
            // Á°Æ‰øù a ÊòØËæÉÂ§ßÁöÑÊï∞
            if(a < b) {
                [a, b] = [b, a];
            }

            let originalA = a;
            let originalB = b;
            let factors = [];
            let factTemp = 2;

            function addStepRow(factor, num1, num2, isResult = false) {
                const row = document.createElement('div');
                row.className = 'step-row';
                row.style.setProperty('--index', stepIndex++);

                if (!isResult) {
                    row.innerHTML = `
                        <div class="factor-box">${factor}</div>
                        <div class="number-block">
                            <div class="number-box">${num1}</div>
                            <div class="number-box">${num2}</div>
                        </div>
                    `;
                } else {
                    row.innerHTML = `
                        <div class="factor-box" style="visibility: hidden;">0</div>
                        <div class="number-block">
                            <div class="number-box">${num1}</div>
                            <div class="number-box">${num2}</div>
                        </div>
                    `;
                }
                stepsDiv.appendChild(row);
                
                // Ê∑ªÂä†Ëá™Âä®ÊªöÂä®
                setTimeout(() => {
                    row.scrollIntoView({ behavior: 'smooth', block: 'end' });
                }, stepIndex * 200); // ‰∏éÂä®ÁîªÂª∂ËøüÂêåÊ≠•
            }

            while(factTemp <= a/2 + 1) {
                if(a % factTemp === 0 && b % factTemp === 0) {
                    addStepRow(factTemp, a, b);
                    a /= factTemp;
                    b /= factTemp;
                    factors.push(factTemp);
                    factTemp = 1;
                }
                factTemp++;
            }

            addStepRow('', a, b, true);

            let gcd = factors.reduce((acc, curr) => acc * curr, 1);
            let lcm = (originalA * originalB) / gcd;

            resultDiv.innerHTML = '';
            const resultContent = [
                { label: 'ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞', value: gcd },
                { label: 'ÊúÄÂ∞èÂÖ¨ÂÄçÊï∞', value: lcm }
            ];

            resultContent.forEach((item, index) => {
                const p = document.createElement('div');
                p.className = 'step-row result-row';
                p.style.setProperty('--index', stepIndex + index);
                p.innerHTML = `
                    <div class="result-label">${item.label}Ôºö</div>
                    <div class="number-box result-value">${item.value}</div>
                `;
                resultDiv.appendChild(p);
            });
        }

        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.body.style.opacity = '0';
            
            setTimeout(() => {
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                document.body.style.opacity = '1';
            }, 300);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.body.style.opacity = '1';
        });
    </script>
</body>
</html>